<!DOCTYPE html>
<html lang="en"><head>
<link href="../../media/web-favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.32">

  <title>Entomology 5126 – Week 5</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-207d2aaea499fbf291ebd3ef4299628c.css">
  <link rel="stylesheet" href="default">
  <link rel="stylesheet" href="slide_styles/slide-styles.css">
  <link rel="stylesheet" href="slide_styles/slide-styles.scss">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Week 5</h1>
  <p class="subtitle">Simple linear regression</p>

<div class="quarto-title-authors">
</div>

</section>
<section>
<section id="what-well-cover-today" class="title-slide slide level1 center">
<h1>What we’ll cover today</h1>

</section>
<section id="more-tools-to-detect-differences-among-samples" class="slide level2">
<h2>More tools to detect differences among samples</h2>
<div class="fragment">
<div class="box-1-list">
<p><span class="margin-1"><i class="fa-solid fa-chart-simple" aria-label="chart-simple"></i></span> Two-Way ANOVA</p>
</div>
</div>
<div class="fragment">
<div class="box-1-list">
<p><span class="margin-1"><i class="fa-solid fa-wrench" aria-label="wrench"></i></span> Linear model diagnostics</p>
</div>
</div>
<div class="fragment">
<p>But first…</p>
</div>
</section>
<section id="a-quiz" class="slide level2">
<h2>A quiz!</h2>
<p><strong>A quiz - what is it? It’s a small assessment of knowledge, but that’s not important right now.</strong> <img data-src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExcHN0OHdiN2I5Y2d3MjB3NXFjOTI3dm90YnAwODBmcWc0ZGRhZGU0ayZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/l4FATJpd4LWgeruTK/giphy.gif" class="quarto-figure quarto-figure-center" width="1000"></p>
</section>
<section id="lets-check-our-anova-memory-from-last-week" class="slide level2">
<h2>Let’s check our ANOVA memory from last week…</h2>
<p>We’ve learned a few ways to assess the differences between samples of data, so far mostly through comparing the <em>expected</em> values, or means. These questions will address the concepts we’ve discussed so far.</p>
</section>
<section id="section" class="slide level2 scrollable">
<h2></h2>
<ol type="1">
<li>Assume we have 3 independent samples of plants grown in different fertilizer regimes and we want to compare their total height after 30 days. Given the choice between conducting and ANOVA and three independent, two-sample t-tests, which would you choose and why?</li>
</ol>
<div class="fragment">
<ol start="2" type="1">
<li>All this talk of Z-tests, one-sample t-tests, two-sample t-tests, and dependent and independent t-tests is making my head spin! Help me! Why do we use t-tests rather than z-tests most of the time? What’s the difference between dependent and independent two-sample t-tests?</li>
</ol>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<ol start="3" type="1">
<li>Look! I did an ANOVA! What the *!&amp;$ does it mean?! Give me a 30-second elevator pitch about what this particular <code>summary()</code> output tells us.</li>
</ol>
</div><div class="column" style="width:50%;">
<pre><code>Call:
lm(formula = size_cm ~ trt, data = w2.fact.df)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.4641 -2.1500 -0.1284  1.3719  5.5777 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   6.3872     0.8894   7.181 1.01e-07 ***
trttrtA      -0.2686     1.2578  -0.214    0.832    
trttrtB       1.3430     1.2578   1.068    0.295    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.813 on 27 degrees of freedom
Multiple R-squared:  0.06525,   Adjusted R-squared:  -0.003987 
F-statistic: 0.9424 on 2 and 27 DF,  p-value: 0.4021</code></pre>
</div></div>
</div>
</section>
<section id="nice-work" class="slide level2">
<h2>Nice work!</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://i.sstatic.net/AFpya.gif" class="quarto-figure quarto-figure-center" width="800"></p>
</figure>
</div>
</section></section>
<section>
<section id="two-way-anova" class="title-slide slide level1 center">
<h1>Two-way ANOVA</h1>

</section>
<section id="two-way-anova-1" class="slide level2">
<h2>Two-way ANOVA</h2>
<p>Last week, we discussed 1-factor or “1-way” ANOVA. This let us compare the means of 2+ groups and determine whether there was any evidence that one or more groups were different than the others.</p>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> For example, is there a difference in the mean number of insects captured among 3 different colored sticky cards placed adjacent to a soybean field.</p>
</div>
</div>
<div class="fragment">
<div class="box-6-list">
<p>Cool! But what about when we have an experiment with <span class="highlight-tomato">more than 1 treatment factor</span> (e.g., temperature and precipitation?)</p>
</div>
</div>
</section>
<section id="analysis-of-variance-anova" class="slide level2">
<h2>Analysis of variance (ANOVA)</h2>
<p><strong>Two-way ANOVA</strong></p>
<div class="fragment">
<div class="box-6-list">
<p>In a factorial design, two (or more) categorical variables are “crossed” with one another (e.g., two levels of temperature and two levels of irrigation)</p>
</div>
</div>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> This design, also called a fully-factorial, or full-crossed design, yields 4 total treatment combinations that we <em>could</em> analyze in a 1-way ANOVA.</p>
</div>
</div>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> However, such an approach only allows us to determine the impact of each treatment independently, and not their combined or interactive effects with one another!</p>
</div>
</div>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> Two-way ANOVAs let us specifically model the <span class="highlight-tomato">interaction</span> term that examines whether the effect of one treatment variable varies depending on the level of the other treatment.</p>
</div>
</div>
</section>
<section id="example-of-2-way-anova" class="slide level2">
<h2>Example of 2-way ANOVA</h2>
<div class="box-6-list">
<p>Imagine that we are doing an experiment testing the impact of two temperature treatments on the growth of plants. We cross our temperature treatments with duration to understand how the effect of temperature may be mediated by the time of exposure. We can lay out our experimental design as such:</p>
</div>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./slide_media/w5/factorial-design.png" class="quarto-figure quarto-figure-center" height="375"></p>
</figure>
</div>
</div>
</section>
<section id="example-of-2-way-anova-1" class="slide level2">
<h2>Example of 2-way ANOVA</h2>
<div class="box-6-list">
<p>We could analyze this design using a 1-way ANOVA with each treatment combination as an treatment treatment.</p>
</div>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./slide_media/w5/1way-anova.png" class="quarto-figure quarto-figure-center" height="375"></p>
</figure>
</div>
</div>
</section>
<section id="example-of-2-way-anova-2" class="slide level2">
<h2>Example of 2-way ANOVA</h2>
<div class="box-6-list">
<p>When we build our ANOVA table and calculate our p-values, we’re simply testing whether there is some difference among out groups. That is to say, all of our variation is lumped into the <code>treatment</code> variable (i.e., among-group differences)</p>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./slide_media/w5/1way-anova-table.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
<div class="fragment">
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Caution</strong></p>
</div>
<div class="callout-content">
<p>Conducting our analyis in this manner doesn’t allow us to partition the impact of each of our factors of interest!</p>
</div>
</div>
</div>
</div>
</section>
<section id="example-of-2-way-anova-3" class="slide level2">
<h2>Example of 2-way ANOVA</h2>
<div class="box-6-list">
<p>Instead, we an build our model to account for the experimental design, fitting terms for both our temperature and duration, as well as their interaction!</p>
</div>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./slide_media/w5/2way-anova.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</section>
<section id="example-of-2-way-anova-4" class="slide level2">
<h2>Example of 2-way ANOVA</h2>
<div class="box-6-list">
<p>Now, when we build our ANOVA table, we can explicitly partition the variance between our two treatments and their interactive effect</p>
</div>
<div class="fragment">
<<<<<<< HEAD
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> While the r value quantifies the correlation between our variables, it tells us nothing about <span class="highlight-tomato">uncertainty</span> or the fit/usefullness of our model because…</p>
</div>
</div>
</section>
<section id="section" class="slide level2">
<h2></h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="slide_media/w5/spoon-model.jpg" class="quarto-figure quarto-figure-center" width="800"></p>
=======
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./slide_media/w5/2way-anova-table.png" class="quarto-figure quarto-figure-center" height="300"></p>
>>>>>>> 5cd9c72 (update labs)
</figure>
</div>
</section>
<section id="why-cant-we-just-stop-at-our-correlation-coefficient-1" class="slide level2">
<h2>Why can’t we just stop at our correlation coefficient?</h2>
<div class="box-6-list">
<p>Linear regression lets us futher build out the model of our system so that we can <span class="highlight-tomato">estimate the strength of a biological relationship</span> rather than simply a mathematical one!</p>
</div>
</section>
<section id="example-of-2-way-anova-5" class="slide level2">
<h2>Example of 2-way ANOVA</h2>
<div class="box-6-list">
<p>We can further visualize the how the 2-way anova differs from the 1-way anova by reconsructing the group means of our four treatment combinations:</p>
</div>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./slide_media/w5/2way-estimates.png" class="quarto-figure quarto-figure-center" height="275"></p>
</figure>
</div>
</div>
</section>
<section id="analysis-of-variance-anova-1" class="slide level2">
<h2>Analysis of variance (ANOVA)</h2>
<p><strong>Two-way ANOVA | The ANOVA table</strong></p>
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 18%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 8%">
<col style="width: 24%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th><em>df</em></th>
<th>SS</th>
<th>MS</th>
<th>F-ratio</th>
<th><em>P</em>-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Factor A</td>
<td><span class="math inline">\(a - 1\)</span></td>
<td>(see PES pg. 305)</td>
<td><span class="math inline">\(\frac{SS_{factor A}}{df_{factor A}}\)</span></td>
<td><span class="math inline">\(\frac{MS_A}{MS_{error}}\)</span></td>
<td></td>
</tr>
<tr class="even">
<td>Factor B</td>
<td><span class="math inline">\(b - 1\)</span></td>
<td>(see PES pg. 305)</td>
<td><span class="math inline">\(\frac{SS_{factor B}}{df_{factor B}}\)</span></td>
<td><span class="math inline">\(\frac{MS_B}{MS_{error}}\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td>A x B interaction</td>
<td><span class="math inline">\((a-1)(b-1)\)</span></td>
<td>(see PES pg. 305)</td>
<td><span class="math inline">\(\frac{SS_{interaction}}{df_{interaction}}\)</span></td>
<td><span class="math inline">\(\frac{MS_{AB}}{MS_{error}}\)</span></td>
<td></td>
</tr>
<tr class="even">
<td>Error</td>
<td><span class="math inline">\(ab(n-1)\)</span></td>
<td>(see PES pg. 305)</td>
<td><span class="math inline">\(\frac{SS_{error}}{df_{error}}\)</span></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(abn-1\)</span></td>
<td>(see PES pg. 305)</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="fragment">
<p>Here, you can test 3 <span class="math inline">\(F\)</span>-ratios: two main effects and their interaction. All use the <span class="math inline">\(MS_{error}\)</span> term in the denominator!</p>
</div>
</section>
<section id="visualizing-statistical-interactions" class="slide level2">
<h2>Visualizing statistical interactions</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./slide_media/w5/interaction-plots.png" class="quarto-figure quarto-figure-center" height="550"></p>
</figure>
</div>
</section></section>
<section>
<section id="model-diagnostics" class="title-slide slide level1 center">
<h1>Model diagnostics</h1>

</section>
<section id="linear-model-assumptions" class="slide level2 scrollable">
<h2>Linear model assumptions</h2>
<p><strong>ANOVA, Linear Models (regression), t-tests, and beyond!</strong></p>
<div class="fragment">
<ol type="1">
<li>Model is correct</li>
</ol>
</div>
<div class="fragment">
<ol start="2" type="1">
<li>Samples are independent across and within treatments</li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>Variance is homogeneous among groups (i.e., each group contributes ~ equally to the within group sum of squares; <span class="math inline">\(\sigma_1^2 = \sigma_2^2 = ... = \sigma_k^2\)</span>)</li>
</ol>
</div>
<div class="fragment">
<ol start="4" type="1">
<li>Residuals are normally distributed</li>
</ol>
</div>
<div class="fragment">
<div class="box-6-list">
<p>These assumptions are listed from mostest to most important (because none of them are <em>not</em> important)</p>
</div>
</div>
</section></section>
<section>
<section id="a-quiz" class="title-slide slide level1 center">
<h1>A quiz!</h1>

</section>
<section id="lets-check-our-two-way-anova-and-regression-memory-from-last-week" class="slide level2">
<h2>Let’s check our two-way ANOVA and regression memory from last week…</h2>
<p>We’re slowly building up an arsenal of different linear models that we can use to test hypotheses about both differences between samples (ANOVA), and relationships between variables (regression)!</p>
</section>
<section id="section-1" class="slide level2 scrollable">
<h2></h2>
<div class="box-6-list">
<p>Let’s imagine we did an experiment where we manipulated two categorical variables, temperature and water availability for plants, with two levels (high and low) for each.</p>
</div>
<div class="fragment">
<ol type="1">
<li>What type of experiment is this called?</li>
</ol>
</div>
<div class="fragment">
<ol start="2" type="1">
<li>What sort of analysis should we use to test for the effects of temperature and water on our plant response variables? Defend your choice of analysis.</li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>We fit a model for this experiment with <code>lm(plant_response ~ temp_trt * water_trt)</code> and print the summary below. What is it telling us? Sketch out a figure that shows approximately what these results look like.</li>
</ol>
<pre><code>Residuals:
     Min       1Q   Median       3Q      Max 
-5.1032  -1.7324   0.1186   1.9541   5.4410 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                15.420      0.812   18.99  &lt; 2e-16 ***
temp_trtWarm               3.180      1.149    2.77   0.008 ** 
water_trtHigh              4.025      1.149    3.50   0.001 ***
temp_trtWarm:water_trtHigh 2.635      1.625    1.62   0.112    
---
Signif. codes:
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.58 on 36 degrees of freedom
Multiple R-squared:  0.541,    Adjusted R-squared:  0.504 
F-statistic: 14.1 on 3 and 36 DF,  p-value: 1.6e-06</code></pre>
</div>
</section>
<section id="section-2" class="slide level2 scrollable">
<h2></h2>
<div class="box-6-list">
<p>Now let’s imagine that we conducted a study where we examined how plant growth responded to a natural temperature variation across the whole biogeographical range of the species.</p>
</div>
<div class="fragment">
<ol type="1">
<li>Here’s the print out of that linear regression model summary. What is it telling us?</li>
</ol>
<pre><code>Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     12.3845     1.7421   7.11  1.2e-09 ***
temperature_C    0.8532     0.1216   7.02  1.8e-09 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 3.12 on 48 degrees of freedom
Multiple R-squared:  0.506,   Adjusted R-squared:  0.495 
F-statistic: 49.3 on 1 and 48 DF,  p-value: 1.8e-09</code></pre>
</div>
<div class="fragment">
<ol start="2" type="1">
<li>We take a look at our residual vs.&nbsp;fitted diagnostic plot to see this. What does this indicate?</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="slide_media/w5/resid-nonlinear-tpc.png" class="quarto-figure quarto-figure-center" width="400"></p>
</figure>
</div>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>How should we interpret the “significance” of this model given the manner in which the data were collected?</li>
</ol>
</div>
</section>
<section id="linear-model-assumptions-1" class="slide level2">
<h2>Linear model assumptions</h2>
<p><strong>Assumption 1: Model is correct</strong></p>
<div class="box-6-list">
<p>This is the art of statistics! We can plug experimental data into just about any model framework in the computer and have it spit out some stuff for us to interpret. But is it meaningful?</p>
</div>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> Folks tend to look for p-values before they look for anything else. This is a one of the perverse incentives from the publishing rat-race we’re all apart of.</p>
</div>
</div>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> This assumption is best addressed through common sense and attention to detail. And…</p>
</div>
</div>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> …conducting your analyses consistent with the manner in which you conduct your experiment/observational studies.</p>
</div>
</div>
</section>
<section id="linear-model-assumptions-2" class="slide level2">
<h2>Linear model assumptions</h2>
<p><strong>Assumption 2: Samples are independent across and within treatments</strong></p>
<div class="box-6-list">
<p>These details are best sorted at the experimental and study design phase. Recall the discussions we’ve had about bias, randomization, etc.</p>
</div>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> This assumption is nothing that we can test or visualize to assess; we simply must critique the experimental methods/procedure used to collect our samples.</p>
</div>
</div>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> Recall the discussions we’ve had about bias, randomization, etc.</p>
</div>
</div>
</section>
<section id="linear-model-assumptions-3" class="slide level2">
<h2>Linear model assumptions</h2>
<p><strong>Assumption 3: Variance is homogenous among groups</strong></p>
<div class="box-6-list">
<p>Equal variance can be assessed using tests (e.g., Levene’s test), but in practice we tend to assess this assumption <strong>visually</strong> using residual plots</p>
</div>
</section>
<<<<<<< HEAD
<section id="section-3" class="slide level2">
<h2></h2>
<p><span class="math display">\[SSTotal = \sum_{i = 1}^{n}(y_i - \bar{y})^2, ~df = n - 1\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="w5_2-slides_files/figure-revealjs/unnamed-chunk-11-1.png" width="960"></p>
</figure>
=======
<section id="linear-model-assumptions-4" class="slide level2">
<h2>Linear model assumptions</h2>
<p><strong>Assumption 4: Residuals are normally distributed</strong></p>
<div class="box-6-list">
<p>Till now, we have been simplifying this assumption, saying something like: each treatment is a random sample <span class="math inline">\(Y_{ij} \sim N(\mu_i, \sigma_i^2)\)</span>. Technically, this isn’t quite correct (but it gets us most of the way there)</p>
>>>>>>> 5cd9c72 (update labs)
</div>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> We actually care the most about our residual error distribution; that is, we want our model to be “wrong” consistently and have these errors follow a random sample <span class="math inline">\(Y_{ij} \sim N(0, \sigma_i^2)\)</span></p>
</div>
</div>
</section>
<section id="section-4" class="slide level2">
<h2></h2>
<div class="center-xy">
<p><strong>Cool. But how do we actually assess these assumptions in our analyses?</strong></p>
</div>
</section>
<section id="residual-plots" class="slide level2">
<h2>Residual plots</h2>
<div class="box-6-list">
<p>For linear models, we can assess many of our assumptions by examining <span class="highlight-tomato">residual plots</span></p>
</div>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> A residual plot graphs our residual values, <span class="math inline">\(r_i\)</span> against our fitted model values, <span class="math inline">\(\hat{y}_i\)</span>.</p>
</div>
</div>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> If we add up all of our residuals, <span class="math inline">\(\sum_{i=1}^{n} r_i = 0\)</span> and <span class="math inline">\(\sum_{i=1}^{n} r_i^2 = SSError\)</span> aka within-group variance</p>
</div>
</div>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> We can assess our assumptions of equal variance and normally distributed residuals with a single residual plot!</p>
</div>
</div>
</section>
<section id="residual-plots-1" class="slide level2">
<h2>Residual plots</h2>
<p><strong>Ideal residual plots</strong></p>
<div class="box-6-list">
<p>Ideally, residual plots should look like a random scattering of points surrounding a horizontal line with a y-intercept of 0 (i.e., no difference between fitted value and actual data)</p>
</div>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./slide_media/w5/resid-normal.png" class="quarto-figure quarto-figure-center" width="450"></p>
</figure>
</div>
</div>
</section>
<<<<<<< HEAD
<section id="section-5" class="slide level2">
<h2></h2>
<p><span class="math display">\[SSError = \sum_{i = 1}^{n}(y_i - \hat{y_i})^2, ~ df = n - 2\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
=======
<section id="residual-plots-2" class="slide level2">
<h2>Residual plots</h2>
<p><strong>Ideal residual plots</strong></p>
<div class="box-6-list">
<p>We also want to see our <span class="highlight-tomato">residuals normally distributed</span> about <span class="math inline">\(\mu_{d_i} = 0\)</span> - we don’t want our model to be systematically over- or under-predicting true values. this would indicate we’re missing an important variable from our model</p>
</div>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
>>>>>>> 5cd9c72 (update labs)
<figure>
<p><img data-src="./slide_media/w5/resid-normal-dist.png" class="quarto-figure quarto-figure-center" height="375"></p>
</figure>
</div>
</div>
</section>
<<<<<<< HEAD
<section id="section-6" class="slide level2">
<h2></h2>
<p><span class="math display">\[SSTotal = SSReg + SSErr\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
=======
<section id="residual-plots-3" class="slide level2">
<h2>Residual plots</h2>
<p><strong>Non-linear fit</strong></p>
<div class="box-6-list">
<p>When residuals are correlated with the fitted values, this is indicative of a non-linear relationship between our predictor and response variable.</p>
</div>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
>>>>>>> 5cd9c72 (update labs)
<figure>
<p><img data-src="./slide_media/w5/resid-nonlinear.png" class="quarto-figure quarto-figure-center" width="500"></p>
</figure>
</div>
</div>
</section>
<section id="residual-plots-4" class="slide level2">
<h2>Residual plots</h2>
<p><strong>Non-linear fit</strong></p>
<div class="box-6-list">
<p>A “U” or inverted “U” shape to our residuals tends to indicate a quadratic rather than a linear relationship between our predictor and response variable.</p>
</div>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./slide_media/w5/resid-quadratic.png" class="quarto-figure quarto-figure-center" width="500"></p>
</figure>
</div>
</div>
</section>
<section id="residual-plots-5" class="slide level2">
<h2>Residual plots</h2>
<p><strong>Heteroscedasticity</strong></p>
<div class="box-6-list">
<p>Residual plots displaying an increasing or decreasing funnel of points when plotted against fitted indicate that our nonhomogeneous variance, or <span class="highlight-tomato">heteroscedasticity</span></p>
</div>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./slide_media/w5/resid-hetero.png" class="quarto-figure quarto-figure-center" width="500"></p>
</figure>
</div>
</div>
</section>
<section id="residual-plots-6" class="slide level2">
<h2>Residual plots</h2>
<p><strong>Outliers/leverage</strong></p>
<div class="box-6-list">
<p>Residual plots can also help us evaluate whether certain values may be <span class="highlight-tomato">outliers</span> and exhibiting significant leverage on our fitted models.</p>
</div>
<div class="fragment">
<<<<<<< HEAD
<p>We can then calculate the tail probability on <span class="math inline">\(F_{1, 5}\)</span>, p-value &lt;&lt; 0.01. Reject <span class="math inline">\(H_0\)</span>! We have strong evidence that the slope is not 0.</p>
</div>
</section>
<section id="simple-linear-regression-18" class="slide level2">
<h2>Simple linear regression</h2>
<p><strong>Snowfall example | Step 4: Hypothesis testing</strong></p>
<div class="box-6-list">
<p>Alternatively, we can conduct this hypothesis test using a t-test:</p>
</div>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> <span class="math inline">\(\hat{b}_1\)</span> is a function of our random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, thus it is itself a random variable</p>
</div>
<p><span class="math display">\[\hat b_1 = \frac{\sum_{i=1}^n (x_i-\bar x)(Y_i-\bar Y)}{\sum_{i=1}^n (x_i-\bar x)^2} = \frac{\sum_{i=1}^n (x_i-\bar x) Y_i}{\sum_{i=1}^n (x_i-\bar x)^2}\]</span></p>
</div>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> Because <span class="math inline">\(\hat{b}_1\)</span> is a weighted sum of random distributions, it also has a normal distribution so we can use the t-test to determine if <span class="math inline">\(\hat{b}_1\)</span> is significantly different from 0.</p>
</div>
<p><span class="math display">\[t = \frac{\bar{x} - \mu}{SE} = \frac{\hat{b}_1 - b_1^*}{s_{\hat{b}_1}} = \frac{1.356}{0.0877} = 15.46\]</span></p>
</div>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> <span class="math inline">\(p &lt; 0.01\)</span>, so we can reject the null hypothesis (<span class="math inline">\(H_0: b_1 = 0\)</span>)</p>
</div>
</div>
</section>
<section id="simple-linear-regression-19" class="slide level2">
<h2>Simple linear regression</h2>
<p><strong>Snowfall example | Step 4: Hypothesis testing</strong></p>
<p>Check out the summary of our <code>lm</code> object to see this in action:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = hours_to_clear_streets ~ snowfall_inches, data = snowfall)

Residuals:
      1       2       3       4       5       6       7 
 0.2159  0.1564  0.5294 -0.1005 -0.4264 -0.5504  0.1755 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      0.34552    0.34688   0.996    0.365    
snowfall_inches  1.35579    0.08855  15.311 2.16e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4188 on 5 degrees of freedom
Multiple R-squared:  0.9791,    Adjusted R-squared:  0.9749 
F-statistic: 234.4 on 1 and 5 DF,  p-value: 2.156e-05</code></pre>
</div>
</div>
<div class="fragment">
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Caution</strong></p>
</div>
<div class="callout-content">
<p>This only holds up when our model has a numerator degrees of freedom of 1 (i.e., 1 predictor variable in the model!)</p>
</div>
</div>
</div>
</div>
</section>
<section id="simple-linear-regression-20" class="slide level2">
<h2>Simple linear regression</h2>
<p><strong>Snowfall example | Step 4: Hypothesis testing</strong></p>
<div class="box-6-list">
<p>We can conduct a similar t-test to assess the significance of our model intercept, this is similar to what we did in 1 and 2-way ANOVA. I’ll spare you the math here, and just jump to the conclusions</p>
</div>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> If we are testing <span class="math inline">\(H_0: b_0 = 0\)</span> then the t-test for the intercept can be seen as choosing between <span class="math inline">\(Y_i = b_1 x_1 + e_i\)</span> (a model with no intercept) and the model <span class="math inline">\(Y_i = b_0 + b_1 * x_i + e_i\)</span> under the <span class="math inline">\(H_A\)</span>.</p>
</div>
</div>
<div class="fragment">
<div class="indented-text">
<p><i class="fa-solid fa-turn-up fa-rotate-90"></i> We almost <em>always</em> leave the intercept in our models, unless we have a strong biological rationale for forcing the intercept through the origin (0,0).</p>
</div>
</div>
</section>
<section id="simple-linear-regression-21" class="slide level2">
<h2>Simple linear regression</h2>
<p><strong>Snowfall example | Step 5: assessing model fit</strong></p>
<ul>
<li><p><span class="math inline">\(R^2\)</span> can be used to assess model fit</p></li>
<li><p><span class="math inline">\(R^2 = \frac{SS~Regression}{SS~Total}\)</span></p></li>
<li><p><span class="math inline">\(R^2\)</span> represents the proportion of the total SS that is explained by the regression model</p></li>
</ul>
</section>
<section id="link-between-r-and-r2" class="slide level2">
<h2>Link between <span class="math inline">\(r\)</span> and <span class="math inline">\(R^2\)</span></h2>
<ul>
<li>Correlation is important in regression analysis</li>
<li>In lab, you will (or have) learned that <span class="math inline">\(R^2\)</span> is the proportion of variation in the response variable explained by our experimental factor</li>
<li>Put mathematically, <span class="math inline">\(R^2 = \frac{SSTrt}{SSTotal}\)</span></li>
<li>For a simple linear regression <span class="math inline">\(R^2 = r^2\)</span>.</li>
<li>Put another way, <span class="math inline">\(r = \sqrt{R^2}\)</span></li>
</ul>
</section>
<section id="simple-linear-regression-22" class="slide level2">
<h2>Simple linear regression</h2>
<p><strong>Snowfall example | Step 6: make predictions</strong></p>
<p>Yay! We have a model! We can use it to make predictions, like, how many hours should we expect to clear the streets given 4” of snowfall?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a><span class="fu">predict</span>(m1, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="st">"snowfall_inches"</span> <span class="ot">=</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
5.768693 </code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Caution</strong></p>
</div>
<div class="callout-content">
<p>Be careful! Interpolation (predicting between our observed values) is generally okay, but extrapolation (predicting outside our observed values) may be inaccurate if the linear relationship changes outside the range of our observed variables.</p>
</div>
</div>
=======
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./slide_media/w5/resid-outlier.png" class="quarto-figure quarto-figure-center" height="375"></p>
</figure>
>>>>>>> 5cd9c72 (update labs)
</div>


</div>
</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../../media/5126-header.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'slow',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>